"use client";

import Link from "next/link";
import { FC, useEffect, useState } from "react";
import CityConfirmPopup from "./CityConfirmPopup";
import CitySelectionModal from "./CitySelectionModal";
import { useLocalStorage } from "usehooks-ts";

interface IHeaderProps {
  cityCookie: string;
}

const Header: FC<IHeaderProps> = ({ cityCookie }) => {
  const [userCity, setUserCity] = useLocalStorage("userCity", cityCookie);
  const [isOpenModal, setIsOpenModal] = useState<boolean>(false);

  useEffect(() => {
    setUserCity(userCity);
  }, [userCity, setUserCity]);

  return (
    <header className="bg-white py-6 md:border-b lg:border-agray">
      <div className="container">
        <div className="flex justify-between items-center">
          <div className="flex items-center gap-x-[70px]">
            <Link href="/">
              <svg
                className="w-[88px] h-[24px] md:w-[123px] md:h-[33px]"
                width="205"
                height="55"
                viewBox="0 0 205 55"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M192.56 44.254V16.4376H205V10.746H172.803V16.4376H185.245V44.254H192.56ZM162.612 29.0822V36.6681C162.612 37.9317 161.988 38.5646 160.736 38.5646H150.421C147.92 38.5646 146.917 36.9835 146.917 33.8212C146.917 30.6612 147.92 29.08 150.421 29.08H162.612V29.0822ZM141.793 10.746V16.4376H157.986C161.111 16.4376 162.612 18.08 162.612 21.2423V23.3928H147.608C141.982 23.3928 139.355 27.5011 139.355 33.8234C139.355 40.7786 141.982 44.2562 147.608 44.2562H164.299C168.05 44.2562 169.925 42.3597 169.925 38.5668V20.6116C169.925 14.9222 166.863 10.7482 160.611 10.7482H141.793V10.746ZM111.158 17.8282H120.661C126.913 17.8282 128.037 22.7599 128.037 27.8164C128.037 34.7695 126.913 38.9413 119.407 38.9413C114.407 38.9413 111.156 36.92 111.156 31.2305V17.8282H111.158ZM133.666 5.68943V0H115.847C107.722 0 103.843 4.86821 103.843 13.087V31.2305C103.843 41.9765 108.908 44.6329 119.535 44.6329C132.665 44.6329 135.602 39.826 135.602 27.8164C135.602 17.0683 132.102 12.1388 122.285 12.1388H111.158C111.158 7.08222 114.221 5.68943 119.223 5.68943H133.666ZM75.6463 18.08C75.6463 17.007 76.335 16.4376 77.5217 16.4376H83.7111C90.7754 16.4376 91.5269 21.1153 91.5269 27.4354C91.5269 33.7577 90.7754 38.5646 83.7111 38.5646H75.6463V18.08ZM73.9593 10.746C70.2084 10.746 68.333 12.6424 68.333 16.4376V55H75.6463V44.254H85.5237C96.1527 44.254 99.0915 37.5529 99.0915 27.4354C99.0915 17.3223 96.1549 10.746 85.5237 10.746H73.9593Z"
                  fill="#DF0000"
                />
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M2.08506 0H61.2483C62.3998 0 63.3333 0.933511 63.3333 2.08506V52.9149C63.3333 54.0665 62.3998 55 61.2483 55H2.08505C0.93351 55 0 54.0665 0 52.9149V2.08506C0 0.933511 0.933511 0 2.08506 0ZM40.0474 37.1119V29.087V29.0847H27.1409C24.4955 29.0847 23.434 30.7573 23.434 34.1003C23.434 37.4455 24.4955 39.1182 27.1409 39.1182H38.0622C39.3849 39.1182 40.0474 38.4486 40.0474 37.1119ZM18.0102 15.7105V9.69185H37.9292C44.5475 9.69185 47.7889 14.1074 47.7889 20.1261V39.1205C47.7889 43.1329 45.8037 45.1392 41.8332 45.1392H24.1654C18.2073 45.1392 15.4289 41.4603 15.4289 34.1026C15.4289 27.4144 18.2073 23.0683 24.1654 23.0683H40.0474V20.7933C40.0474 17.4481 38.4587 15.7105 35.1484 15.7105H18.0102Z"
                  fill="#DF0000"
                />
              </svg>
            </Link>
            <div className="relative">
              <div
                onClick={() => setIsOpenModal(true)}
                className="flex items-center gap-x-[10px] cursor-pointer"
              >
                <svg
                  className="w-[9px] h-3 lg:w-[13px] lg:h-[19px]"
                  width="13"
                  height="19"
                  viewBox="0 0 13 19"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M5.82267 17.9122L0.568176 9.40979C0.568176 9.40979 -1.07385 6.13964 1.22499 2.8695C3.52383 -0.400641 9.58656 -0.177049 11.734 2.8695C13.8814 5.91605 12.7192 8.75575 12.3908 9.40979C12.0624 10.0638 7.1363 17.9122 7.1363 17.9122C6.62312 18.6767 6.33582 18.7149 5.82267 17.9122ZM6.47957 9.40972C7.93056 9.40972 9.10682 8.23844 9.10682 6.7936C9.10682 5.34876 7.93056 4.17749 6.47957 4.17749C5.02858 4.17749 3.85233 5.34876 3.85233 6.7936C3.85233 8.23844 5.02858 9.40972 6.47957 9.40972Z"
                    fill="#E2061A"
                  />
                </svg>

                <span className="font-medium leading-[22px] hover:text-ared">
                  {userCity}
                </span>
              </div>

              <CityConfirmPopup setIsOpenModal={setIsOpenModal} />
            </div>
            <Link
              href="tel:+7(4942)36-00-61"
              className="flex items-center gap-x-[10px] cursor-pointer"
            >
              <svg
                className="w-[18px] h-[18px]"
                width="18"
                height="19"
                viewBox="0 0 18 19"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M17.6715 16.3329C17.5519 16.452 17.4078 16.6044 17.255 16.7655C16.8736 17.1703 16.3971 17.6734 16.0985 17.8775C14.5274 18.9511 12.4254 18.4374 10.9386 17.8179C8.97727 17.0007 6.8419 15.4944 4.92457 13.5768C3.00544 11.6591 1.49927 9.52303 0.682053 7.56281C0.0632974 6.07569 -0.4515 3.97333 0.622286 2.40183C0.826194 2.103 1.33052 1.62729 1.73475 1.24518C1.89647 1.09281 2.04764 0.948843 2.16717 0.829698C2.37938 0.618539 2.66657 0.5 2.96594 0.5C3.26531 0.5 3.55251 0.618539 3.76472 0.829698L6.65557 3.71971C6.86661 3.93191 6.98508 4.21902 6.98508 4.5183C6.98508 4.81759 6.86661 5.1047 6.65557 5.3169L5.86806 6.10283C5.60507 6.3639 5.4334 6.70292 5.37861 7.06943C5.32382 7.43594 5.38884 7.81034 5.564 8.13691C6.64716 10.1813 8.31937 11.8532 10.3639 12.936C10.6904 13.1111 11.0648 13.1761 11.4312 13.1212C11.7976 13.0663 12.1364 12.8945 12.3973 12.6315L13.1829 11.8455C13.3951 11.6343 13.6823 11.5158 13.9817 11.5158C14.281 11.5158 14.5682 11.6343 14.7804 11.8455L17.6715 14.736C17.8825 14.9481 18.001 15.2352 18.001 15.5344C18.001 15.8337 17.8825 16.1207 17.6715 16.3329Z"
                  fill="#E2061A"
                />
              </svg>

              <span className="font-medium leading-[22px] hover:text-ared">
                + 7 (4942) 36-00-61
              </span>
            </Link>
          </div>

          <div className="flex items-center border border-border2 rounded-[10px]">
            <Link className="p-3" href="/favorits">
              <svg
                className="w-[22px] h-[22px]"
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.305 5.21767C18.6327 4.33434 17.683 3.70264 16.6084 3.42405C15.5339 3.14546 14.3968 3.23614 13.38 3.68154C12.47 4.07427 11.6583 4.73642 11 5.61513C10.3417 4.73427 9.53004 4.07212 8.61996 3.68154C7.60315 3.23614 6.46614 3.14546 5.39159 3.42405C4.31704 3.70264 3.36732 4.33434 2.695 5.21767C1.98602 6.14666 1.61133 7.30767 1.61133 8.57482C1.61133 10.3984 2.69887 12.399 4.84344 14.5234C6.59098 16.2538 8.65605 17.6709 9.73113 18.3614C10.1099 18.6038 10.5503 18.7327 11 18.7327C11.4497 18.7327 11.8901 18.6038 12.2689 18.3614C13.3431 17.6709 15.409 16.2538 17.1566 14.5234C19.3011 12.3999 20.3887 10.3984 20.3887 8.57482C20.3887 7.30767 20.014 6.14666 19.305 5.21767Z"
                  fill="#E2061A"
                />
              </svg>
            </Link>
          </div>
        </div>
      </div>

      <CitySelectionModal isOpen={isOpenModal} setIsOpen={setIsOpenModal} />
    </header>
  );
};

export default Header;
